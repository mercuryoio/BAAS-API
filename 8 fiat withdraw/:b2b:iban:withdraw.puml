@startuml
' This UML source uses PlantUML format.
' https://plantuml.com/sequence-diagram for syntax details.
' Optional styles

skinparam shadowing false
skinparam SequenceMessageAlign direction

autonumber

actor User as user
<<<<<<< HEAD
participant "Partner" as part
participant "Mercuryo" as merc

user -> part: Купить крипту
part -> merc: /lib/currencies()
part -> merc: /sdk-partner/sign-in()
part -> merc: /b2b/user/data()
part -> merc: getUserIban()
part -> merc: IBAN withdraw
=======
participant "Partner/Merchant" as part
participant "Mercuryo WebApp" as merc
participant "Mercuryo Wallet" as wall
participant "BCGateWay" as bc

user -> part: Продажа криптовалюты
part -> merc: /lib/currencies()
part -> merc: /lib/countries()
part -> merc: /sdk-partner/sign-in()
== fiat_withdraw from User M IBAN to IBAN from interface 8 ==
part -> merc: IBAN withdraw
merc -> merc: create fiat iban-payout (складываем все выводы на айбаны)
note right
 IBAN From
 IBAN To
 Amount
 Currency
end note
merc -> wall: IBAN API send(IBAN, Amount)
note right
 (moneyswap to user)
end note
wall -> wall: trx_id iban
wall -> merc: oki
merc o-> part: Trx Pending Status Callback
wall -> wall: trx_id crypto2fiat
merc o-> part: Trx W Complete Status Callback
====
>>>>>>> ee548d4a4b31c6ec7d186da904bedf460012f1ff
merc --> merc: Transaction
part -> merc: /b2b/buy/:merch_trx_id:/status()
merc --> part: 'complete'
part --> user: Transaction Result

@enduml
